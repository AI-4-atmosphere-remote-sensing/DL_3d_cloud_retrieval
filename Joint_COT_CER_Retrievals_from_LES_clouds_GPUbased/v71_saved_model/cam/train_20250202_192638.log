2025-02-02 19:26:38,521 - cloud_retrieval - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.12.6 | packaged by conda-forge | (main, Sep 22 2024, 14:16:49) [GCC 13.3.0]
CUDA available: True
GPU 0,1,2,3: Tesla T4
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 12.1, V12.1.105
GCC: gcc (GCC) 7.3.1 20180712 (Red Hat 7.3.1-17)
PyTorch: 2.4.1
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.1-Product Build 20220311 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 12.4
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.4, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

TorchVision: 0.19.1
OpenCV: 4.10.0
MMCV: 1.6.2
MMCV Compiler: n/a
MMCV CUDA Compiler: n/a
------------------------------------------------------------

2025-02-02 19:26:39,900 - cloud_retrieval - INFO - ====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
DataParallel                                       [128, 2, 20, 20]          --
├─CAM: 1-1                                         [32, 2, 20, 20]           468,192
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-1                             [32, 32, 20, 20]          9,920
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-1                        [32, 32, 20, 20]          9,920
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-3                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-3                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-3                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-5                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-5                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-5                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-7                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-7                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-7                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-9                                   [32, 32, 20, 20]          --
│    └─CBAM: 2-19                                  --                        (recursive)
│    │    └─ChannelGate: 3-9                       [32, 32, 20, 20]          --
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-12                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-19                                  --                        (recursive)
│    │    └─ChannelGate: 3-11                      [32, 32, 20, 20]          --
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-15                                  [32, 32, 20, 20]          162
│    └─CBAM: 2-19                                  --                        (recursive)
│    │    └─ChannelGate: 3-13                      [32, 32, 20, 20]          162
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-18                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-19                                  --                        (recursive)
│    │    └─ChannelGate: 3-15                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-16                      --                        162
│    └─Down: 2-20                                  [32, 64, 10, 10]          --
│    └─Down: 2-41                                  --                        (recursive)
│    │    └─Sequential: 3-17                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-38                       --                        (recursive)
│    └─Down: 2-22                                  [32, 64, 10, 10]          --
│    └─Down: 2-41                                  --                        (recursive)
│    │    └─Sequential: 3-19                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-38                       --                        (recursive)
│    └─Down: 2-24                                  [32, 64, 10, 10]          55,552
│    └─Down: 2-41                                  --                        (recursive)
│    │    └─Sequential: 3-21                       [32, 64, 10, 10]          55,552
│    │    └─Sequential: 3-38                       --                        (recursive)
│    └─Down: 2-26                                  [32, 64, 10, 10]          --
│    └─Down: 2-41                                  --                        (recursive)
│    │    └─Sequential: 3-23                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-38                       --                        (recursive)
│    └─CBAM: 2-28                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-25                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-41                                  --                        (recursive)
│    │    └─Sequential: 3-38                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─CBAM: 2-32                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-29                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-41                                  --                        (recursive)
│    │    └─Sequential: 3-38                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-36                                  [32, 128, 5, 5]           --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-33                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-41                                  --                        (recursive)
│    │    └─Sequential: 3-38                       --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─Down: 2-41                                  --                        (recursive)
│    │    └─Sequential: 3-38                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─CBAM: 2-43                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-40                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─CBAM: 2-45                                  [32, 64, 10, 10]          580
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-42                      [32, 64, 10, 10]          580
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-51                                  [32, 128, 5, 5]           --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-48                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─CBAM: 2-57                                  --                        (recursive)
│    │    └─ChannelGate: 3-54                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─Up: 2-59                                    [32, 64, 10, 10]          --
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-56                  [32, 64, 10, 10]          --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─Down: 2-62                                  [32, 128, 5, 5]           --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-58                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─Down: 2-64                                  [32, 128, 5, 5]           221,696
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-60                       [32, 128, 5, 5]           221,696
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─Up: 2-66                                    [32, 64, 10, 10]          --
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-62                  [32, 64, 10, 10]          --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─Up: 2-69                                    [32, 64, 10, 10]          --
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-64                  [32, 64, 10, 10]          --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-65                       --                        (recursive)
│    └─Up: 2-72                                    [32, 64, 10, 10]          143,680
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-66                  [32, 64, 10, 10]          32,832
│    │    └─Dropout: 3-67                          [32, 64, 10, 10]          --
│    │    └─Dropout: 3-68                          [32, 64, 10, 10]          --
│    │    └─Dropout: 3-69                          [32, 64, 10, 10]          --
│    │    └─Dropout: 3-70                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-71                       [32, 64, 10, 10]          110,848
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    │    └─DoubleConv: 3-73                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    │    └─DoubleConv: 3-75                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-74                                    [32, 32, 20, 20]          36,000
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─ConvTranspose2d: 3-77                  [32, 32, 20, 20]          8,224
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    │    └─DoubleConv: 3-79                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─Dropout: 3-81                          [32, 32, 20, 20]          --
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─DoubleConv: 3-83                       [32, 32, 20, 20]          27,776
│    │    └─DoubleConv: 3-112                      --                        (recursive)
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-81                                    [32, 32, 20, 20]          --
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─ConvTranspose2d: 3-86                  [32, 32, 20, 20]          --
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-84                                    [32, 32, 20, 20]          --
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─ConvTranspose2d: 3-88                  [32, 32, 20, 20]          --
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─Dropout: 3-90                          [32, 32, 20, 20]          --
│    │    └─Dropout: 3-91                          [32, 32, 20, 20]          --
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─DoubleConv: 3-112                      --                        (recursive)
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─DoubleConv: 3-95                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-112                      --                        (recursive)
│    │    └─DoubleConv: 3-97                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-112                      --                        (recursive)
│    └─DoubleConv: 2-92                            [32, 1, 20, 20]           301
│    └─DoubleConv: 2-112                           --                        (recursive)
│    │    └─Sequential: 3-99                       [32, 1, 20, 20]           301
│    │    └─Sequential: 3-122                      --                        (recursive)
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─DoubleConv: 3-112                      --                        (recursive)
│    └─Up: 2-95                                    --                        (recursive)
│    │    └─DoubleConv: 3-102                      --                        (recursive)
│    └─Up: 2-96                                    [32, 32, 20, 20]          --
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─ConvTranspose2d: 3-103                 [32, 32, 20, 20]          --
│    │    └─Dropout: 3-104                         [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-112                      --                        (recursive)
│    │    └─DoubleConv: 3-106                      [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-112                      --                        (recursive)
│    └─DoubleConv: 2-98                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-112                           --                        (recursive)
│    │    └─Sequential: 3-108                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-122                      --                        (recursive)
│    └─DoubleConv: 2-100                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-112                           --                        (recursive)
│    │    └─Sequential: 3-110                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-122                      --                        (recursive)
│    └─Up: 2-102                                   --                        (recursive)
│    │    └─DoubleConv: 3-112                      --                        (recursive)
│    └─DoubleConv: 2-103                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-112                           --                        (recursive)
│    │    └─Sequential: 3-113                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-122                      --                        (recursive)
│    └─DoubleConv: 2-105                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-117                           --                        (recursive)
│    │    └─Sequential: 3-115                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-127                      --                        (recursive)
│    └─DoubleConv: 2-112                           --                        (recursive)
│    │    └─Sequential: 3-122                      --                        (recursive)
│    └─DoubleConv: 2-108                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-117                           --                        (recursive)
│    │    └─Sequential: 3-118                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-127                      --                        (recursive)
│    └─DoubleConv: 2-112                           --                        (recursive)
│    │    └─Sequential: 3-122                      --                        (recursive)
│    └─DoubleConv: 2-117                           --                        (recursive)
│    │    └─Sequential: 3-127                      --                        (recursive)
│    └─DoubleConv: 2-112                           --                        (recursive)
│    │    └─Sequential: 3-122                      --                        (recursive)
│    └─DoubleConv: 2-117                           --                        (recursive)
│    │    └─Sequential: 3-127                      --                        (recursive)
│    └─DoubleConv: 2-114                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-117                           --                        (recursive)
│    │    └─Sequential: 3-124                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-127                      --                        (recursive)
│    └─DoubleConv: 2-116                           [32, 1, 20, 20]           301
│    └─DoubleConv: 2-117                           --                        (recursive)
│    │    └─Sequential: 3-126                      [32, 1, 20, 20]           301
│    │    └─Sequential: 3-127                      --                        (recursive)
====================================================================================================
Total params: 2,525,574
Trainable params: 2,525,574
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 1.41
====================================================================================================
Input size (MB): 0.41
Forward/backward pass size (MB): 48.39
Params size (MB): 1.87
Estimated Total Size (MB): 50.67
====================================================================================================
2025-02-02 19:26:39,904 - cloud_retrieval - INFO - Predicts cot,CER from r1 and r2 
2025-02-02 19:26:39,904 - cloud_retrieval - INFO - Parameters info:
------------------------------------------------------------
saved_model_path: v71_saved_model/cam/cam_fold_0_20250202_192638.pth
batch: 512
optimizer: SGD
lr: 0.01
loss: MSE
scheduler: None
num_epochs: 2
patience: 1
w1: 1.0
w2: 1.0
p_batch_size: 128
patch_size: 20
------------------------------------------------------------

2025-02-02 19:26:47,426 - cloud_retrieval - INFO - [1/2] train_loss: 0.61288 valid_loss: 0.41689 lr: 0.01  
2025-02-02 19:26:54,557 - cloud_retrieval - INFO - [2/2] train_loss: 0.58718 valid_loss: 0.40766 lr: 0.01  
2025-02-02 19:26:57,455 - cloud_retrieval - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.12.6 | packaged by conda-forge | (main, Sep 22 2024, 14:16:49) [GCC 13.3.0]
CUDA available: True
GPU 0,1,2,3: Tesla T4
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 12.1, V12.1.105
GCC: gcc (GCC) 7.3.1 20180712 (Red Hat 7.3.1-17)
PyTorch: 2.4.1
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.1-Product Build 20220311 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 12.4
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.4, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

TorchVision: 0.19.1
OpenCV: 4.10.0
MMCV: 1.6.2
MMCV Compiler: n/a
MMCV CUDA Compiler: n/a
------------------------------------------------------------

2025-02-02 19:26:57,513 - cloud_retrieval - INFO - ====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
DataParallel                                       [128, 2, 20, 20]          --
├─CAM: 1-1                                         [32, 2, 20, 20]           468,192
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-1                             [32, 32, 20, 20]          9,920
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-1                        [32, 32, 20, 20]          9,920
│    │    └─Sequential: 3-17                       --                        (recursive)
├─CAM: 1-3                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-3                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-3                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-17                       --                        (recursive)
├─CAM: 1-5                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-5                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-5                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-17                       --                        (recursive)
├─CAM: 1-7                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-7                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-7                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-17                       --                        (recursive)
│    └─CBAM: 2-9                                   [32, 32, 20, 20]          162
│    └─CBAM: 2-23                                  --                        (recursive)
│    │    └─ChannelGate: 3-9                       [32, 32, 20, 20]          162
│    │    └─ChannelGate: 3-23                      --                        (recursive)
│    └─CBAM: 2-11                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-23                                  --                        (recursive)
│    │    └─ChannelGate: 3-11                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-23                      --                        (recursive)
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-17                       --                        (recursive)
│    └─CBAM: 2-23                                  --                        (recursive)
│    │    └─ChannelGate: 3-23                      --                        (recursive)
│    └─CBAM: 2-15                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-23                                  --                        (recursive)
│    │    └─ChannelGate: 3-15                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-23                      --                        (recursive)
│    └─DoubleConv: 2-17                            --                        (recursive)
│    │    └─Sequential: 3-17                       --                        (recursive)
│    └─CBAM: 2-23                                  --                        (recursive)
│    │    └─ChannelGate: 3-23                      --                        (recursive)
│    └─CBAM: 2-19                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-23                                  --                        (recursive)
│    │    └─ChannelGate: 3-19                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-23                      --                        (recursive)
│    └─Down: 2-21                                  [32, 64, 10, 10]          --
│    └─Down: 2-39                                  --                        (recursive)
│    │    └─Sequential: 3-21                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-39                       --                        (recursive)
│    └─CBAM: 2-23                                  --                        (recursive)
│    │    └─ChannelGate: 3-23                      --                        (recursive)
│    └─Down: 2-39                                  --                        (recursive)
│    │    └─Sequential: 3-39                       --                        (recursive)
│    └─Down: 2-25                                  [32, 64, 10, 10]          55,552
│    └─Down: 2-39                                  --                        (recursive)
│    │    └─Sequential: 3-25                       [32, 64, 10, 10]          55,552
│    │    └─Sequential: 3-39                       --                        (recursive)
│    └─Down: 2-27                                  [32, 64, 10, 10]          --
│    └─Down: 2-39                                  --                        (recursive)
│    │    └─Sequential: 3-27                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-39                       --                        (recursive)
│    └─Down: 2-29                                  [32, 64, 10, 10]          --
│    └─Down: 2-39                                  --                        (recursive)
│    │    └─Sequential: 3-29                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-39                       --                        (recursive)
│    └─CBAM: 2-31                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-31                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─Down: 2-39                                  --                        (recursive)
│    │    └─Sequential: 3-39                       --                        (recursive)
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─Down: 2-39                                  --                        (recursive)
│    │    └─Sequential: 3-39                       --                        (recursive)
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─CBAM: 2-37                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-37                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─Down: 2-39                                  --                        (recursive)
│    │    └─Sequential: 3-39                       --                        (recursive)
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─CBAM: 2-41                                  [32, 64, 10, 10]          580
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-41                      [32, 64, 10, 10]          580
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─CBAM: 2-43                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-43                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─Down: 2-45                                  [32, 128, 5, 5]           --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-45                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─Down: 2-48                                  [32, 128, 5, 5]           --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-48                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─CBAM: 2-50                                  --                        (recursive)
│    │    └─ChannelGate: 3-50                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Down: 2-52                                  [32, 128, 5, 5]           --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-52                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Down: 2-54                                  [32, 128, 5, 5]           221,696
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-54                       [32, 128, 5, 5]           221,696
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Up: 2-56                                    [32, 64, 10, 10]          --
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-56                  [32, 64, 10, 10]          --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─Dropout: 3-58                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-59                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Up: 2-61                                    [32, 64, 10, 10]          --
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-62                  [32, 64, 10, 10]          --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─Dropout: 3-64                          [32, 64, 10, 10]          --
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    │    └─DoubleConv: 3-67                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-67                                    [32, 64, 10, 10]          --
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-69                  [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─Dropout: 3-72                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Down: 2-71                                  --                        (recursive)
│    │    └─Sequential: 3-74                       --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-75                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-73                                    [32, 64, 10, 10]          143,680
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-77                  [32, 64, 10, 10]          32,832
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    │    └─Dropout: 3-79                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    │    └─DoubleConv: 3-81                       [32, 64, 10, 10]          110,848
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-75                                    [32, 32, 20, 20]          --
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─ConvTranspose2d: 3-83                  [32, 32, 20, 20]          --
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─Dropout: 3-85                          [32, 32, 20, 20]          --
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-87                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-82                                    [32, 32, 20, 20]          --
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─ConvTranspose2d: 3-90                  [32, 32, 20, 20]          --
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─Dropout: 3-92                          [32, 32, 20, 20]          --
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-94                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─Up: 2-92                                    --                        (recursive)
│    │    └─DoubleConv: 3-100                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─Up: 2-94                                    [32, 32, 20, 20]          --
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─ConvTranspose2d: 3-102                 [32, 32, 20, 20]          --
│    └─Up: 2-96                                    [32, 32, 20, 20]          36,000
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─ConvTranspose2d: 3-103                 [32, 32, 20, 20]          8,224
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    │    └─Dropout: 3-105                         [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    │    └─Dropout: 3-107                         [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    │    └─DoubleConv: 3-109                      [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    │    └─DoubleConv: 3-111                      [32, 32, 20, 20]          27,776
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─DoubleConv: 2-98                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-113                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─DoubleConv: 2-101                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-116                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-111                           [32, 1, 20, 20]           301
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-126                      [32, 1, 20, 20]           301
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─Up: 2-115                                   --                        (recursive)
│    │    └─DoubleConv: 3-130                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-117                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-132                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-119                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-134                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-121                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-136                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-132                           [32, 1, 20, 20]           301
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-147                      [32, 1, 20, 20]           301
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-136                           --                        (recursive)
│    │    └─Sequential: 3-151                      --                        (recursive)
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-154                      --                        (recursive)
│    └─DoubleConv: 2-138                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-139                           --                        (recursive)
│    │    └─Sequential: 3-153                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-154                      --                        (recursive)
====================================================================================================
Total params: 2,525,574
Trainable params: 2,525,574
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 1.41
====================================================================================================
Input size (MB): 0.41
Forward/backward pass size (MB): 48.39
Params size (MB): 1.87
Estimated Total Size (MB): 50.67
====================================================================================================
2025-02-02 19:26:57,517 - cloud_retrieval - INFO - Predicts cot,CER from r1 and r2 
2025-02-02 19:26:57,517 - cloud_retrieval - INFO - Parameters info:
------------------------------------------------------------
saved_model_path: v71_saved_model/cam/cam_fold_1_20250202_192657.pth
batch: 512
optimizer: SGD
lr: 0.01
loss: MSE
scheduler: None
num_epochs: 2
patience: 1
w1: 1.0
w2: 1.0
p_batch_size: 128
patch_size: 20
------------------------------------------------------------

2025-02-02 19:27:04,638 - cloud_retrieval - INFO - [1/2] train_loss: 0.53482 valid_loss: 0.38527 lr: 0.01  
2025-02-02 19:27:11,813 - cloud_retrieval - INFO - [2/2] train_loss: 0.50183 valid_loss: 0.38536 lr: 0.01  
2025-02-02 19:27:14,583 - cloud_retrieval - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.12.6 | packaged by conda-forge | (main, Sep 22 2024, 14:16:49) [GCC 13.3.0]
CUDA available: True
GPU 0,1,2,3: Tesla T4
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 12.1, V12.1.105
GCC: gcc (GCC) 7.3.1 20180712 (Red Hat 7.3.1-17)
PyTorch: 2.4.1
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.1-Product Build 20220311 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 12.4
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.4, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

TorchVision: 0.19.1
OpenCV: 4.10.0
MMCV: 1.6.2
MMCV Compiler: n/a
MMCV CUDA Compiler: n/a
------------------------------------------------------------

2025-02-02 19:27:14,641 - cloud_retrieval - INFO - ====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
DataParallel                                       [128, 2, 20, 20]          --
├─CAM: 1-1                                         [32, 2, 20, 20]           468,192
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-1                             [32, 32, 20, 20]          9,920
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-1                        [32, 32, 20, 20]          9,920
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-3                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-3                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-3                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-5                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-5                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-5                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-7                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-7                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-7                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-9                                   [32, 32, 20, 20]          162
│    └─CBAM: 2-20                                  --                        (recursive)
│    │    └─ChannelGate: 3-9                       [32, 32, 20, 20]          162
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-20                                  --                        (recursive)
│    │    └─ChannelGate: 3-19                      --                        (recursive)
│    └─CBAM: 2-13                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-20                                  --                        (recursive)
│    │    └─ChannelGate: 3-12                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-19                      --                        (recursive)
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-20                                  --                        (recursive)
│    │    └─ChannelGate: 3-19                      --                        (recursive)
│    └─CBAM: 2-17                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-20                                  --                        (recursive)
│    │    └─ChannelGate: 3-16                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-19                      --                        (recursive)
│    └─CBAM: 2-19                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-20                                  --                        (recursive)
│    │    └─ChannelGate: 3-18                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-19                      --                        (recursive)
│    └─Down: 2-21                                  [32, 64, 10, 10]          --
│    └─Down: 2-35                                  --                        (recursive)
│    │    └─Sequential: 3-20                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-34                       --                        (recursive)
│    └─Down: 2-23                                  [32, 64, 10, 10]          55,552
│    └─Down: 2-35                                  --                        (recursive)
│    │    └─Sequential: 3-22                       [32, 64, 10, 10]          55,552
│    │    └─Sequential: 3-34                       --                        (recursive)
│    └─Down: 2-25                                  [32, 64, 10, 10]          --
│    └─Down: 2-35                                  --                        (recursive)
│    │    └─Sequential: 3-24                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-34                       --                        (recursive)
│    └─Down: 2-27                                  [32, 64, 10, 10]          --
│    └─Down: 2-35                                  --                        (recursive)
│    │    └─Sequential: 3-26                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-34                       --                        (recursive)
│    └─CBAM: 2-29                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-28                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-45                      --                        (recursive)
│    └─Down: 2-35                                  --                        (recursive)
│    │    └─Sequential: 3-34                       --                        (recursive)
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-45                      --                        (recursive)
│    └─Down: 2-35                                  --                        (recursive)
│    │    └─Sequential: 3-34                       --                        (recursive)
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-45                      --                        (recursive)
│    └─Down: 2-35                                  --                        (recursive)
│    │    └─Sequential: 3-34                       --                        (recursive)
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-45                      --                        (recursive)
│    └─CBAM: 2-37                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-36                      [32, 64, 10, 10]          --
│    └─CBAM: 2-39                                  [32, 64, 10, 10]          580
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-37                      [32, 64, 10, 10]          580
│    │    └─ChannelGate: 3-45                      --                        (recursive)
│    └─CBAM: 2-41                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-39                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-45                      --                        (recursive)
│    └─Down: 2-43                                  [32, 128, 5, 5]           --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-41                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-58                       --                        (recursive)
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-45                      --                        (recursive)
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-58                       --                        (recursive)
│    └─CBAM: 2-47                                  --                        (recursive)
│    │    └─ChannelGate: 3-45                      --                        (recursive)
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-58                       --                        (recursive)
│    └─Down: 2-49                                  [32, 128, 5, 5]           221,696
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-47                       [32, 128, 5, 5]           221,696
│    │    └─Sequential: 3-58                       --                        (recursive)
│    └─Down: 2-51                                  [32, 128, 5, 5]           --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-49                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-58                       --                        (recursive)
│    └─Down: 2-53                                  [32, 128, 5, 5]           --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-51                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-58                       --                        (recursive)
│    └─Up: 2-55                                    [32, 64, 10, 10]          --
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-53                  [32, 64, 10, 10]          --
│    │    └─Dropout: 3-54                          [32, 64, 10, 10]          --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-58                       --                        (recursive)
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─DoubleConv: 3-56                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-58                       --                        (recursive)
│    └─Up: 2-60                                    [32, 64, 10, 10]          143,680
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-59                  [32, 64, 10, 10]          32,832
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-62                                    [32, 64, 10, 10]          --
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-61                  [32, 64, 10, 10]          --
│    │    └─Dropout: 3-62                          [32, 64, 10, 10]          --
│    │    └─Dropout: 3-63                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    │    └─DoubleConv: 3-65                       [32, 64, 10, 10]          110,848
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-64                                    [32, 64, 10, 10]          --
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-67                  [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-68                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    │    └─Dropout: 3-70                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-71                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-66                                    [32, 32, 20, 20]          --
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-73                  [32, 32, 20, 20]          --
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─Dropout: 3-75                          [32, 32, 20, 20]          --
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-77                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-73                                    [32, 32, 20, 20]          36,000
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-80                  [32, 32, 20, 20]          8,224
│    │    └─Dropout: 3-81                          [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-82                       [32, 32, 20, 20]          27,776
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─Up: 2-79                                    --                        (recursive)
│    │    └─DoubleConv: 3-88                       --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─Up: 2-81                                    [32, 32, 20, 20]          --
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-90                  [32, 32, 20, 20]          --
│    └─Up: 2-83                                    [32, 32, 20, 20]          --
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-91                  [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    │    └─Dropout: 3-93                          [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    │    └─DoubleConv: 3-95                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    │    └─Dropout: 3-97                          [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    │    └─DoubleConv: 3-99                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─DoubleConv: 2-85                            [32, 1, 20, 20]           301
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-101                      [32, 1, 20, 20]           301
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─DoubleConv: 2-88                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-104                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─DoubleConv: 2-93                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-109                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─Up: 2-97                                    --                        (recursive)
│    │    └─DoubleConv: 3-113                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-99                            [32, 1, 20, 20]           301
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-115                      [32, 1, 20, 20]           301
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-103                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-119                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-105                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-121                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-118                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-134                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-122                           --                        (recursive)
│    │    └─Sequential: 3-138                      --                        (recursive)
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-141                      --                        (recursive)
│    └─DoubleConv: 2-124                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-125                           --                        (recursive)
│    │    └─Sequential: 3-140                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-141                      --                        (recursive)
====================================================================================================
Total params: 2,525,574
Trainable params: 2,525,574
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 1.41
====================================================================================================
Input size (MB): 0.41
Forward/backward pass size (MB): 48.39
Params size (MB): 1.87
Estimated Total Size (MB): 50.67
====================================================================================================
2025-02-02 19:27:14,645 - cloud_retrieval - INFO - Predicts cot,CER from r1 and r2 
2025-02-02 19:27:14,645 - cloud_retrieval - INFO - Parameters info:
------------------------------------------------------------
saved_model_path: v71_saved_model/cam/cam_fold_2_20250202_192714.pth
batch: 512
optimizer: SGD
lr: 0.01
loss: MSE
scheduler: None
num_epochs: 2
patience: 1
w1: 1.0
w2: 1.0
p_batch_size: 128
patch_size: 20
------------------------------------------------------------

2025-02-02 19:27:21,801 - cloud_retrieval - INFO - [1/2] train_loss: 0.59924 valid_loss: 0.42658 lr: 0.01  
2025-02-02 19:27:28,988 - cloud_retrieval - INFO - [2/2] train_loss: 0.59854 valid_loss: 0.42658 lr: 0.01  
2025-02-02 19:27:31,658 - cloud_retrieval - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.12.6 | packaged by conda-forge | (main, Sep 22 2024, 14:16:49) [GCC 13.3.0]
CUDA available: True
GPU 0,1,2,3: Tesla T4
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 12.1, V12.1.105
GCC: gcc (GCC) 7.3.1 20180712 (Red Hat 7.3.1-17)
PyTorch: 2.4.1
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.1-Product Build 20220311 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 12.4
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.4, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

TorchVision: 0.19.1
OpenCV: 4.10.0
MMCV: 1.6.2
MMCV Compiler: n/a
MMCV CUDA Compiler: n/a
------------------------------------------------------------

2025-02-02 19:27:31,715 - cloud_retrieval - INFO - ====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
DataParallel                                       [128, 2, 20, 20]          --
├─CAM: 1-1                                         [32, 2, 20, 20]           468,192
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-1                             [32, 32, 20, 20]          9,920
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-1                        [32, 32, 20, 20]          9,920
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-3                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-3                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-3                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-5                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-5                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-5                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
├─CAM: 1-7                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-7                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-7                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-9                                   [32, 32, 20, 20]          162
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-9                       [32, 32, 20, 20]          162
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-28                      --                        (recursive)
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-28                      --                        (recursive)
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-14                       --                        (recursive)
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-28                      --                        (recursive)
│    └─CBAM: 2-17                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-16                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-28                      --                        (recursive)
│    └─CBAM: 2-19                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-18                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-28                      --                        (recursive)
│    └─CBAM: 2-21                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-20                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-28                      --                        (recursive)
│    └─Down: 2-23                                  [32, 64, 10, 10]          55,552
│    └─Down: 2-34                                  --                        (recursive)
│    │    └─Sequential: 3-22                       [32, 64, 10, 10]          55,552
│    │    └─Sequential: 3-33                       --                        (recursive)
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-28                      --                        (recursive)
│    └─Down: 2-34                                  --                        (recursive)
│    │    └─Sequential: 3-33                       --                        (recursive)
│    └─Down: 2-27                                  [32, 64, 10, 10]          --
│    └─Down: 2-34                                  --                        (recursive)
│    │    └─Sequential: 3-26                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-33                       --                        (recursive)
│    └─CBAM: 2-29                                  --                        (recursive)
│    │    └─ChannelGate: 3-28                      --                        (recursive)
│    └─Down: 2-34                                  --                        (recursive)
│    │    └─Sequential: 3-33                       --                        (recursive)
│    └─Down: 2-31                                  [32, 64, 10, 10]          --
│    └─Down: 2-34                                  --                        (recursive)
│    │    └─Sequential: 3-30                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-33                       --                        (recursive)
│    └─Down: 2-33                                  [32, 64, 10, 10]          --
│    └─Down: 2-34                                  --                        (recursive)
│    │    └─Sequential: 3-32                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-33                       --                        (recursive)
│    └─CBAM: 2-35                                  [32, 64, 10, 10]          580
│    └─CBAM: 2-42                                  --                        (recursive)
│    │    └─ChannelGate: 3-34                      [32, 64, 10, 10]          580
│    └─CBAM: 2-37                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-42                                  --                        (recursive)
│    │    └─ChannelGate: 3-35                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-40                      --                        (recursive)
│    └─CBAM: 2-39                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-42                                  --                        (recursive)
│    │    └─ChannelGate: 3-37                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-40                      --                        (recursive)
│    └─CBAM: 2-41                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-42                                  --                        (recursive)
│    │    └─ChannelGate: 3-39                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-40                      --                        (recursive)
│    └─Down: 2-43                                  [32, 128, 5, 5]           --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-41                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-57                       --                        (recursive)
│    └─Down: 2-45                                  [32, 128, 5, 5]           --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-43                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-57                       --                        (recursive)
│    └─Down: 2-47                                  [32, 128, 5, 5]           221,696
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-45                       [32, 128, 5, 5]           221,696
│    │    └─Sequential: 3-57                       --                        (recursive)
│    └─Down: 2-49                                  [32, 128, 5, 5]           --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-47                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-57                       --                        (recursive)
│    └─Up: 2-51                                    [32, 64, 10, 10]          --
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-49                  [32, 64, 10, 10]          --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-57                       --                        (recursive)
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─Dropout: 3-51                          [32, 64, 10, 10]          --
│    └─Up: 2-55                                    [32, 64, 10, 10]          --
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-52                  [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-53                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-57                       --                        (recursive)
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─Dropout: 3-56                          [32, 64, 10, 10]          --
│    └─Down: 2-59                                  --                        (recursive)
│    │    └─Sequential: 3-57                       --                        (recursive)
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─DoubleConv: 3-58                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Up: 2-61                                    [32, 64, 10, 10]          143,680
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-60                  [32, 64, 10, 10]          32,832
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Up: 2-63                                    [32, 64, 10, 10]          --
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-62                  [32, 64, 10, 10]          --
│    │    └─Dropout: 3-63                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    │    └─Dropout: 3-65                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-66                       [32, 64, 10, 10]          110,848
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    │    └─DoubleConv: 3-68                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Up: 2-65                                    [32, 32, 20, 20]          --
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-70                  [32, 32, 20, 20]          --
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─Dropout: 3-72                          [32, 32, 20, 20]          --
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─DoubleConv: 3-74                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Up: 2-72                                    [32, 32, 20, 20]          --
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-77                  [32, 32, 20, 20]          --
│    └─Up: 2-74                                    [32, 32, 20, 20]          36,000
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-78                  [32, 32, 20, 20]          8,224
│    │    └─Dropout: 3-79                          [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-80                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    │    └─Dropout: 3-82                          [32, 32, 20, 20]          --
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    │    └─DoubleConv: 3-85                       [32, 32, 20, 20]          27,776
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    └─Up: 2-78                                    --                        (recursive)
│    │    └─DoubleConv: 3-87                       --                        (recursive)
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    └─Up: 2-80                                    [32, 32, 20, 20]          --
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-89                  [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    │    └─Dropout: 3-91                          [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    │    └─DoubleConv: 3-93                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    └─DoubleConv: 2-82                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-95                       [32, 1, 20, 20]           --
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    └─DoubleConv: 2-85                            [32, 1, 20, 20]           301
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-98                       [32, 1, 20, 20]           301
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-89                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-102                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─Up: 2-93                                    --                        (recursive)
│    │    └─DoubleConv: 3-106                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-95                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-108                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-97                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-110                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-129                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-100                           [32, 1, 20, 20]           301
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-113                      [32, 1, 20, 20]           301
│    │    └─Sequential: 3-129                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-129                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-129                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-107                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-120                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-129                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-129                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-129                      --                        (recursive)
│    └─DoubleConv: 2-113                           --                        (recursive)
│    │    └─Sequential: 3-126                      --                        (recursive)
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-129                      --                        (recursive)
│    └─DoubleConv: 2-115                           [32, 1, 20, 20]           --
│    └─DoubleConv: 2-116                           --                        (recursive)
│    │    └─Sequential: 3-128                      [32, 1, 20, 20]           --
│    │    └─Sequential: 3-129                      --                        (recursive)
====================================================================================================
Total params: 2,525,574
Trainable params: 2,525,574
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 1.41
====================================================================================================
Input size (MB): 0.41
Forward/backward pass size (MB): 48.39
Params size (MB): 1.87
Estimated Total Size (MB): 50.67
====================================================================================================
2025-02-02 19:27:31,718 - cloud_retrieval - INFO - Predicts cot,CER from r1 and r2 
2025-02-02 19:27:31,719 - cloud_retrieval - INFO - Parameters info:
------------------------------------------------------------
saved_model_path: v71_saved_model/cam/cam_fold_3_20250202_192731.pth
batch: 512
optimizer: SGD
lr: 0.01
loss: MSE
scheduler: None
num_epochs: 2
patience: 1
w1: 1.0
w2: 1.0
p_batch_size: 128
patch_size: 20
------------------------------------------------------------

2025-02-02 19:27:38,884 - cloud_retrieval - INFO - [1/2] train_loss: 0.60065 valid_loss: 0.42477 lr: 0.01  
