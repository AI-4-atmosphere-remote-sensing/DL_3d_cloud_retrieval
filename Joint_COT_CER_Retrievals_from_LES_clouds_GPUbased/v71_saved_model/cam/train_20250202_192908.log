2025-02-02 19:29:08,687 - cloud_retrieval - INFO - Environment info:
------------------------------------------------------------
sys.platform: linux
Python: 3.12.6 | packaged by conda-forge | (main, Sep 22 2024, 14:16:49) [GCC 13.3.0]
CUDA available: True
GPU 0,1,2,3: Tesla T4
CUDA_HOME: /usr/local/cuda
NVCC: Cuda compilation tools, release 12.1, V12.1.105
GCC: gcc (GCC) 7.3.1 20180712 (Red Hat 7.3.1-17)
PyTorch: 2.4.1
PyTorch compiling details: PyTorch built with:
  - GCC 9.3
  - C++ Version: 201703
  - Intel(R) oneAPI Math Kernel Library Version 2022.1-Product Build 20220311 for Intel(R) 64 architecture applications
  - Intel(R) MKL-DNN v3.4.2 (Git Hash 1137e04ec0b5251ca2b4400a4fd3c667ce843d67)
  - OpenMP 201511 (a.k.a. OpenMP 4.5)
  - LAPACK is enabled (usually provided by MKL)
  - NNPACK is enabled
  - CPU capability usage: AVX512
  - CUDA Runtime 12.4
  - NVCC architecture flags: -gencode;arch=compute_50,code=sm_50;-gencode;arch=compute_60,code=sm_60;-gencode;arch=compute_61,code=sm_61;-gencode;arch=compute_70,code=sm_70;-gencode;arch=compute_75,code=sm_75;-gencode;arch=compute_80,code=sm_80;-gencode;arch=compute_86,code=sm_86;-gencode;arch=compute_90,code=sm_90
  - CuDNN 90.1
  - Magma 2.6.1
  - Build settings: BLAS_INFO=mkl, BUILD_TYPE=Release, CUDA_VERSION=12.4, CUDNN_VERSION=9.1.0, CXX_COMPILER=/opt/rh/devtoolset-9/root/usr/bin/c++, CXX_FLAGS= -D_GLIBCXX_USE_CXX11_ABI=0 -fabi-version=11 -fvisibility-inlines-hidden -DUSE_PTHREADPOOL -DNDEBUG -DUSE_KINETO -DLIBKINETO_NOROCTRACER -DUSE_FBGEMM -DUSE_PYTORCH_QNNPACK -DUSE_XNNPACK -DSYMBOLICATE_MOBILE_DEBUG_HANDLE -O2 -fPIC -Wall -Wextra -Werror=return-type -Werror=non-virtual-dtor -Werror=bool-operation -Wnarrowing -Wno-missing-field-initializers -Wno-type-limits -Wno-array-bounds -Wno-unknown-pragmas -Wno-unused-parameter -Wno-unused-function -Wno-unused-result -Wno-strict-overflow -Wno-strict-aliasing -Wno-stringop-overflow -Wsuggest-override -Wno-psabi -Wno-error=pedantic -Wno-error=old-style-cast -Wno-missing-braces -fdiagnostics-color=always -faligned-new -Wno-unused-but-set-variable -Wno-maybe-uninitialized -fno-math-errno -fno-trapping-math -Werror=format -Wno-stringop-overflow, LAPACK_INFO=mkl, PERF_WITH_AVX=1, PERF_WITH_AVX2=1, PERF_WITH_AVX512=1, TORCH_VERSION=2.4.1, USE_CUDA=ON, USE_CUDNN=ON, USE_CUSPARSELT=1, USE_EXCEPTION_PTR=1, USE_GFLAGS=OFF, USE_GLOG=OFF, USE_GLOO=ON, USE_MKL=ON, USE_MKLDNN=ON, USE_MPI=OFF, USE_NCCL=ON, USE_NNPACK=ON, USE_OPENMP=ON, USE_ROCM=OFF, USE_ROCM_KERNEL_ASSERT=OFF, 

TorchVision: 0.19.1
OpenCV: 4.10.0
MMCV: 1.6.2
MMCV Compiler: n/a
MMCV CUDA Compiler: n/a
------------------------------------------------------------

2025-02-02 19:29:10,064 - cloud_retrieval - INFO - ====================================================================================================
Layer (type:depth-idx)                             Output Shape              Param #
====================================================================================================
DataParallel                                       [128, 2, 20, 20]          --
├─CAM: 1-1                                         [32, 2, 20, 20]           468,192
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-1                             [32, 32, 20, 20]          9,920
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-1                        [32, 32, 20, 20]          9,920
│    │    └─Sequential: 3-12                       --                        (recursive)
├─CAM: 1-3                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-3                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-3                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-12                       --                        (recursive)
├─CAM: 1-5                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-5                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-5                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-12                       --                        (recursive)
├─CAM: 1-7                                         [32, 2, 20, 20]           --
├─CAM: 1-8                                         --                        (recursive)
│    └─DoubleConv: 2-7                             [32, 32, 20, 20]          --
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-7                        [32, 32, 20, 20]          --
│    │    └─Sequential: 3-12                       --                        (recursive)
│    └─CBAM: 2-9                                   [32, 32, 20, 20]          --
│    └─CBAM: 2-17                                  --                        (recursive)
│    │    └─ChannelGate: 3-9                       [32, 32, 20, 20]          --
│    └─CBAM: 2-11                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-17                                  --                        (recursive)
│    │    └─ChannelGate: 3-10                      [32, 32, 20, 20]          --
│    └─CBAM: 2-13                                  [32, 32, 20, 20]          162
│    └─CBAM: 2-17                                  --                        (recursive)
│    │    └─ChannelGate: 3-11                      [32, 32, 20, 20]          162
│    └─DoubleConv: 2-15                            --                        (recursive)
│    │    └─Sequential: 3-12                       --                        (recursive)
│    └─CBAM: 2-16                                  [32, 32, 20, 20]          --
│    └─CBAM: 2-17                                  --                        (recursive)
│    │    └─ChannelGate: 3-13                      [32, 32, 20, 20]          --
│    │    └─ChannelGate: 3-14                      --                        162
│    └─Down: 2-18                                  [32, 64, 10, 10]          --
│    └─Down: 2-25                                  --                        (recursive)
│    │    └─Sequential: 3-15                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-22                       --                        (recursive)
│    └─Down: 2-20                                  [32, 64, 10, 10]          --
│    └─Down: 2-25                                  --                        (recursive)
│    │    └─Sequential: 3-17                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-22                       --                        (recursive)
│    └─Down: 2-22                                  [32, 64, 10, 10]          --
│    └─Down: 2-25                                  --                        (recursive)
│    │    └─Sequential: 3-19                       [32, 64, 10, 10]          --
│    │    └─Sequential: 3-22                       --                        (recursive)
│    └─Down: 2-24                                  [32, 64, 10, 10]          55,552
│    └─Down: 2-25                                  --                        (recursive)
│    │    └─Sequential: 3-21                       [32, 64, 10, 10]          55,552
│    │    └─Sequential: 3-22                       --                        (recursive)
│    └─CBAM: 2-26                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-33                                  --                        (recursive)
│    │    └─ChannelGate: 3-23                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-30                      --                        (recursive)
│    └─CBAM: 2-28                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-33                                  --                        (recursive)
│    │    └─ChannelGate: 3-25                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-30                      --                        (recursive)
│    └─CBAM: 2-30                                  [32, 64, 10, 10]          580
│    └─CBAM: 2-33                                  --                        (recursive)
│    │    └─ChannelGate: 3-27                      [32, 64, 10, 10]          580
│    │    └─ChannelGate: 3-30                      --                        (recursive)
│    └─CBAM: 2-32                                  [32, 64, 10, 10]          --
│    └─CBAM: 2-33                                  --                        (recursive)
│    │    └─ChannelGate: 3-29                      [32, 64, 10, 10]          --
│    │    └─ChannelGate: 3-30                      --                        (recursive)
│    └─Down: 2-34                                  [32, 128, 5, 5]           --
│    └─Down: 2-47                                  --                        (recursive)
│    │    └─Sequential: 3-31                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-42                       --                        (recursive)
│    └─Down: 2-36                                  [32, 128, 5, 5]           --
│    └─Down: 2-47                                  --                        (recursive)
│    │    └─Sequential: 3-33                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-42                       --                        (recursive)
│    └─Down: 2-38                                  [32, 128, 5, 5]           221,696
│    └─Down: 2-47                                  --                        (recursive)
│    │    └─Sequential: 3-35                       [32, 128, 5, 5]           221,696
│    │    └─Sequential: 3-42                       --                        (recursive)
│    └─Down: 2-40                                  [32, 128, 5, 5]           --
│    └─Down: 2-47                                  --                        (recursive)
│    │    └─Sequential: 3-37                       [32, 128, 5, 5]           --
│    │    └─Sequential: 3-42                       --                        (recursive)
│    └─Up: 2-42                                    [32, 64, 10, 10]          --
│    └─Up: 2-54                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-39                  [32, 64, 10, 10]          --
│    └─Down: 2-47                                  --                        (recursive)
│    │    └─Sequential: 3-42                       --                        (recursive)
│    └─Up: 2-45                                    [32, 64, 10, 10]          --
│    └─Up: 2-54                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-41                  [32, 64, 10, 10]          --
│    └─Down: 2-47                                  --                        (recursive)
│    │    └─Sequential: 3-42                       --                        (recursive)
│    └─Up: 2-48                                    [32, 64, 10, 10]          143,680
│    └─Up: 2-54                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-43                  [32, 64, 10, 10]          32,832
│    └─Up: 2-50                                    [32, 64, 10, 10]          --
│    └─Up: 2-54                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-44                  [32, 64, 10, 10]          --
│    │    └─Dropout: 3-45                          [32, 64, 10, 10]          --
│    │    └─Dropout: 3-46                          [32, 64, 10, 10]          --
│    │    └─Dropout: 3-47                          [32, 64, 10, 10]          --
│    │    └─Dropout: 3-48                          [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-49                       [32, 64, 10, 10]          110,848
│    │    └─DoubleConv: 3-61                       --                        (recursive)
│    │    └─DoubleConv: 3-51                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-61                       --                        (recursive)
│    │    └─DoubleConv: 3-53                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-61                       --                        (recursive)
│    │    └─DoubleConv: 3-55                       [32, 64, 10, 10]          --
│    │    └─DoubleConv: 3-61                       --                        (recursive)
│    └─Up: 2-52                                    [32, 32, 20, 20]          36,000
│    └─Up: 2-68                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-57                  [32, 32, 20, 20]          8,224
│    │    └─Dropout: 3-58                          [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-59                       [32, 32, 20, 20]          27,776
│    │    └─DoubleConv: 3-83                       --                        (recursive)
│    └─Up: 2-54                                    --                        (recursive)
│    │    └─DoubleConv: 3-61                       --                        (recursive)
│    └─Up: 2-55                                    [32, 32, 20, 20]          --
│    └─Up: 2-68                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-62                  [32, 32, 20, 20]          --
│    └─Up: 2-57                                    [32, 32, 20, 20]          --
│    └─Up: 2-68                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-63                  [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-83                       --                        (recursive)
│    │    └─Dropout: 3-65                          [32, 32, 20, 20]          --
│    │    └─Dropout: 3-66                          [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-83                       --                        (recursive)
│    │    └─DoubleConv: 3-68                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-83                       --                        (recursive)
│    │    └─DoubleConv: 3-70                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-83                       --                        (recursive)
│    └─Up: 2-59                                    [32, 32, 20, 20]          --
│    └─Up: 2-68                                    --                        (recursive)
│    │    └─ConvTranspose2d: 3-72                  [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-83                       --                        (recursive)
│    │    └─Dropout: 3-74                          [32, 32, 20, 20]          --
│    └─DoubleConv: 2-61                            [32, 1, 20, 20]           301
│    └─DoubleConv: 2-73                            --                        (recursive)
│    │    └─Sequential: 3-75                       [32, 1, 20, 20]           301
│    │    └─Sequential: 3-88                       --                        (recursive)
│    └─Up: 2-68                                    --                        (recursive)
│    │    └─DoubleConv: 3-77                       [32, 32, 20, 20]          --
│    │    └─DoubleConv: 3-83                       --                        (recursive)
│    └─DoubleConv: 2-64                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-73                            --                        (recursive)
│    │    └─Sequential: 3-79                       [32, 1, 20, 20]           --
│    │    └─Sequential: 3-88                       --                        (recursive)
│    └─DoubleConv: 2-66                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-73                            --                        (recursive)
│    │    └─Sequential: 3-81                       [32, 1, 20, 20]           --
│    │    └─Sequential: 3-88                       --                        (recursive)
│    └─Up: 2-68                                    --                        (recursive)
│    │    └─DoubleConv: 3-83                       --                        (recursive)
│    └─DoubleConv: 2-69                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-73                            --                        (recursive)
│    │    └─Sequential: 3-84                       [32, 1, 20, 20]           --
│    │    └─Sequential: 3-88                       --                        (recursive)
│    └─DoubleConv: 2-71                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-79                            --                        (recursive)
│    │    └─Sequential: 3-86                       [32, 1, 20, 20]           --
│    │    └─Sequential: 3-94                       --                        (recursive)
│    └─DoubleConv: 2-73                            --                        (recursive)
│    │    └─Sequential: 3-88                       --                        (recursive)
│    └─DoubleConv: 2-74                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-79                            --                        (recursive)
│    │    └─Sequential: 3-89                       [32, 1, 20, 20]           --
│    │    └─Sequential: 3-94                       --                        (recursive)
│    └─DoubleConv: 2-76                            [32, 1, 20, 20]           301
│    └─DoubleConv: 2-79                            --                        (recursive)
│    │    └─Sequential: 3-91                       [32, 1, 20, 20]           301
│    │    └─Sequential: 3-94                       --                        (recursive)
│    └─DoubleConv: 2-78                            [32, 1, 20, 20]           --
│    └─DoubleConv: 2-79                            --                        (recursive)
│    │    └─Sequential: 3-93                       [32, 1, 20, 20]           --
│    │    └─Sequential: 3-94                       --                        (recursive)
====================================================================================================
Total params: 2,525,574
Trainable params: 2,525,574
Non-trainable params: 0
Total mult-adds (Units.GIGABYTES): 1.41
====================================================================================================
Input size (MB): 0.41
Forward/backward pass size (MB): 48.39
Params size (MB): 1.87
Estimated Total Size (MB): 50.67
====================================================================================================
2025-02-02 19:29:10,067 - cloud_retrieval - INFO - Predicts cot,CER from r1 and r2 
2025-02-02 19:29:10,067 - cloud_retrieval - INFO - Parameters info:
------------------------------------------------------------
saved_model_path: v71_saved_model/cam/cam_fold_0_20250202_192908.pth
batch: 512
optimizer: SGD
lr: 0.01
loss: MSE
scheduler: None
num_epochs: 2
patience: 1
w1: 1.0
w2: 1.0
p_batch_size: 128
patch_size: 20
------------------------------------------------------------

2025-02-02 19:29:17,634 - cloud_retrieval - INFO - [1/2] train_loss: 0.61288 valid_loss: 0.41689 lr: 0.01  
2025-02-02 19:29:24,665 - cloud_retrieval - INFO - [2/2] train_loss: 0.58718 valid_loss: 0.40767 lr: 0.01  
2025-02-02 19:29:27,450 - cloud_retrieval - INFO - Time: 22.66
2025-02-02 19:29:27,450 - cloud_retrieval - INFO -   Train Loss:  0.4169
  Valid loss:  0.417
  Test COT MSE: 1.0215
   Test CER MSE: 0.0118 
